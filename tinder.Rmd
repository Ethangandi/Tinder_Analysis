---
title: "Tinder Data"
output: html_notebook
---


```{r}
library(FactoMineR)
library(factoextra)
library(dplyr)

tinder<-read.csv("H:/School2024-2025/Data Wrangling/Clustering/tinder_users.db - pays.csv")

str(tinder)
```


Exercise 1: 
Corespondence Analysis is used to find relationships between 2 categorical variables.

Multiple Correspondence Analysis (MCA) is used to compare several categorical variables with eachother. 

Exercise 2:
```{r}
# Removing date columns that won't be used for analysis
date_cols <- c("last.up.photo", "last.pr.update", "last.connex", "date.crea","Country","userid")
tinder <- tinder %>% 
  select(-all_of(date_cols))

# Define the qualitative variable names
qualitative <- c( "photo.beach", "photo.elevator", "laugh", "voyage", "gender")

# Select qualitative columns from the `tinder` DataFrame
tinder_qualitative <- tinder %>% 
  select(all_of(qualitative))

# Select quantitative columns from the `tinder` DataFrame
tinder_quantitative <- tinder %>%
  select(-all_of(qualitative))

# Display the first few rows of the quantitative DataFrame
head(tinder_quantitative)

tinder_qualitative_df <- as.data.frame(tinder_qualitative)
tinder_quantitative_df <- as.data.frame(tinder_quantitative)


```

```{r}
# Convert columns to factors if they aren't already
tinder_qualitative <- tinder_qualitative %>%
  mutate(across(everything(), as.factor))

```

Preforming a pca on the quantative variables of the dataset:
```{r}
tinder_pca<-prcomp(tinder_quantitative,scale=TRUE)
```
Seeing the number of principle components needed to do analysis:
```{r}
library(factoextra)

# Assuming you have already run PCA and have the 'tinder_pca' object

# Compute variance and proportion of variance explained
tinder_var <- tinder_pca$sdev^2
tinder_pve <- tinder_var / sum(tinder_var)

# Create elbow plot
plot(tinder_pve, 
     type = "b", 
     xlab = "# of components", 
     ylab = "% Variance explained", 
     ylim = c(0, 1), 
     main = "Elbow Plot of PCA", 
     pch = 19, col = "blue")

```
The elbow plot tells us that we only need to use 2 principle components to do an analysis.
```{r} 
# Perform MCA
head(tinder_qualitative)
mca_result <- MCA(tinder_qualitative, graph = TRUE)

```
```{r}
# Assuming 'mca_result' contains your MCA analysis result
fviz_screeplot(mca_result, addlabels = TRUE, main = "Elbow Plot for MCA")

head((mca_result$ind$coord))
```
3. We can see that the inertias maintain a similar magnitude with the exception of gender_2.

4.The factor mapping on the PC's show us the significance of each factor on a specific principle component. In real life this tells that having a laughing photo in your profile doesn't significantly impact the score of the profile, whereas having a photo from a trip, or beach are more likly to impact profile score.

5.Contribution of components on a table:
```{r}
# Assuming 'mca_result' is your MCA result
# Extracting variable coordinates
var_coords <- mca_result$var$coord

# Extracting the eigenvalues (variance explained by each axis)
eig_values <- mca_result$eig[, 1]  # First column: eigenvalues

# Compute the contributions of each variable to the first two axes
contrib_pc1 <- (var_coords[, 1]^2) / eig_values[1] * 100  # Contribution to PC1
contrib_pc2 <- (var_coords[, 2]^2) / eig_values[2] * 100  # Contribution to PC2

# Create a data frame with variable names and contributions
contrib_table <- data.frame(
  Variable = rownames(var_coords),
  PC1_Contribution = contrib_pc1,
  PC2_Contribution = contrib_pc2
)

# Display the table of contributions
print(contrib_table)

```
Fix 5 and do 6